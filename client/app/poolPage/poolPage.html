<div header></div>
<div loading class="extraBtn" ng-show="loading"></div>
<h2 class="errMsg" ng-show="error.length">{{error}}</h2>
<div class="poolPageBody fade" ng-show="!error.length && !loading">
<h1 class="poolTitle" ng-hide="loading">{{currPool.name}}</h1>
<br>
<button class="partnerUpBtn" ng-hide="stuView || loading" ng-click="startNewGrouping()">{{creatingGrouping ? "Close" : "Organize New Grouping"}}</button>
<div loading ng-show="loadingNewGrouping"></div>
<div class="newGrouping fade" ng-show="creatingGrouping && !loadingNewGrouping && !stuView">
  <input class="groupingName" ng-model="groupingName" maxlength="20" placeholder="Enter title">
  <button class="reroll" ng-click="randomize()">Re-roll</button>
  <div id="partners" class='pair' unselectable="on" class="unselectable"> 
    <div class="grp" ng-repeat="group in groups" ng-class="{clash: clashes.includes(group)}" >
      <div class="partner" ng-class="{locked: lockedStus[stu.user.uid]}" ng-repeat="stu in group" class="stu"> 
        <img class='portrait' src='{{stu.user.avatar_url}}'>
        <div class='partnerName' ng-class="{selectedStu: selectedForSwap === stu, clickable: !stuView}" ng-click="selectForSwap(stu)">{{stu.user.name}}</div>
        <img class='Grid Grid--cell lockBtn' src= "http://simpleicon.com/wp-content/uploads/lock-3.png" width='15px' height='15px' ng-show='lockedStus[stu.user.uid] === undefined' ng-click="toggleLockStu(stu)">
        <img class='Grid Grid--cell lockBtn' src= "http://image.flaticon.com/icons/svg/26/26053.svg" width='15px' height='15px' ng-show='lockedStus[stu.user.uid] !== undefined' ng-click="toggleLockStu(stu)">
      </div>
    </div>
  </div>
  <button class="finalize" ng-click="finalize()">Finalize Grouping</button>
</div>
<div class="history" ng-show="!loading">
  <h2>Past Groupings</h2>
  <input ng-model="searchHist" placeholder="Search groupings">
  <input ng-model="stuSearch" placeholder="Search for a student">
  <div class="pastGrouping" ng-repeat="grouping in pastGroupings | filter : filterGroupingsByName">
    <h3 class="groupingTitle">{{grouping.generationData.title}}</h3>
    <div unselectable="on" class="groupingUsers unselectable" id="groupingUsers">
      <div class="grp" ng-repeat='grp in grouping.groups | filter : filterGroupsByName'>
        <div class="partner" ng-repeat='partner in grp'>
          <img class="portrait" src='{{idMap[partner].user.avatar_url}}'>
          <!-- {{idMap[partner].user.name}} -->
          <div class="partnerName">{{idMap[partner].user.name}}</div>
        </div>
      </div>
    </div>
    <button class="clipyclip histclip" data-clipboard-target="#groupingUsers">copy me</button>
  </div>
</div>
</div>